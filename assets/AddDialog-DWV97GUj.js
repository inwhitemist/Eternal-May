import{c as j,r,R as L,j as e,B as c,I as p,T as H,C as B,a as E,S as U,u as K,D as O}from"./index-CgvB4RSR.js";import{X as b}from"./x-DtV2K-jO.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=j("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=j("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=j("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);function $({initial:s,onSubmit:g,onCancel:n}){const[h,M]=r.useState((s==null?void 0:s.date)||new Date().toISOString().slice(0,10)),[k,R]=r.useState((s==null?void 0:s.title)||""),[v,W]=r.useState((s==null?void 0:s.description)||""),[d,u]=r.useState((s==null?void 0:s.tags)||[]),[y,w]=r.useState(""),[N,A]=r.useState((s==null?void 0:s.color)||""),[x,m]=r.useState(s==null?void 0:s.imageData),[l,C]=r.useState(!!(s!=null&&s.code)),[S,F]=r.useState((s==null?void 0:s.code)||"");L.useEffect(()=>{l?d.includes("legendary")||u(t=>[...t,"legendary"]):d.includes("legendary")&&u(t=>t.filter(a=>a!=="legendary"))},[l]);function D(){const t=y.trim();t&&(d.includes(t)||u([...d,t]),w(""))}function q(t){var i;const a=(i=t.target.files)==null?void 0:i[0];if(!a)return;if(!a.type.startsWith("image/"))return alert("Выберите изображение");const o=new FileReader;o.onload=()=>m(String(o.result)),o.readAsDataURL(a)}return L.useEffect(()=>{function t(a){var i;const o=(i=a.clipboardData)==null?void 0:i.items;if(o){for(const z of o)if(z.type.startsWith("image/")){const I=z.getAsFile();if(I){a.preventDefault();const f=new FileReader;f.onload=()=>m(String(f.result)),f.readAsDataURL(I)}break}}}return window.addEventListener("paste",t),()=>window.removeEventListener("paste",t)},[]),e.jsxs("form",{onSubmit:t=>{t.preventDefault();const a={id:(s==null?void 0:s.id)||K(),date:h,title:k.trim()||"Без названия",description:v.trim(),tags:d,color:N||void 0,imageData:x,...l?{code:S.trim().toUpperCase()}:{}};g(a)},className:"flex min-h-0 flex-1 flex-col",children:[e.jsxs("div",{className:"grid max-h-[60vh] gap-3 overflow-y-auto pr-1",children:[e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Тип события"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"button",variant:l?"soft":"primary",onClick:()=>C(!1),children:"Обычное"}),e.jsx(c,{type:"button",variant:l?"primary":"soft",onClick:()=>C(!0),children:"Легендарное"})]})]}),l&&e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Код"}),e.jsx(p,{value:S,onChange:t=>F(t.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Дата"}),e.jsx(p,{type:"date",value:h,onChange:t=>M(t.target.value),required:!0})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Заголовок"}),e.jsx(p,{value:k,onChange:t=>R(t.target.value),placeholder:"Например: Переезд в новый город"})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Описание"}),e.jsx(H,{rows:4,value:v,onChange:t=>W(t.target.value),placeholder:"Короткая история/заметки"})]}),e.jsxs("div",{className:"grid gap-1",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Теги"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{value:y,onChange:t=>w(t.target.value),placeholder:"Добавить тег",onKeyDown:t=>t.key==="Enter"&&(t.preventDefault(),D())}),e.jsxs(c,{variant:"soft",onClick:D,type:"button",children:[e.jsx(P,{size:16})," Добавить"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2 pt-1",children:d.map(t=>e.jsx(B,{label:t,onClick:()=>t==="legendary"&&l?void 0:u(d.filter(a=>a!==t))},t))})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx("label",{className:"text-xs text-black/60 dark:text-white/60",children:"Цвет акцента"}),e.jsx("div",{className:"flex flex-wrap items-center gap-3",children:["#60a5fa","#34d399","#f472b6","#fb923c","#a78bfa","#fbbf24"].map(t=>e.jsx("button",{type:"button",onClick:()=>A(t),className:E("h-6 w-6 rounded-full border border-black/20 dark:border-white/10",N===t&&"ring-2 ring-offset-2 ring-indigo-400"),style:{background:t},"aria-label":`Выбрать цвет ${t}`},t))})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("label",{className:"text-xs text-black/60 dark:text-white/60 flex items-center gap-2",children:[e.jsx(T,{size:16})," Фото (необязательно, 1 шт; можно вставить из буфера обмена)"]}),e.jsxs("div",{className:"flex flex-col items-start gap-2",children:[e.jsxs("label",{className:E("relative flex cursor-pointer items-center justify-center rounded-xl border-2 border-dashed border-indigo-300/60 bg-white/60 px-4 py-4 text-sm font-medium transition hover:bg-indigo-50 dark:bg-white/10 dark:hover:bg-indigo-950/20",x&&"border-solid border-indigo-400 bg-indigo-50/60 dark:bg-indigo-900/30"),style:{minHeight:120,minWidth:180,width:"100%",maxWidth:320},children:[x?e.jsx("img",{src:x,alt:"Превью",className:"max-h-28 max-w-full object-contain rounded-lg shadow"}):e.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full gap-2 py-2 text-indigo-500 dark:text-indigo-300",children:[e.jsx(T,{size:32}),e.jsx("span",{className:"text-xs opacity-70",children:"Выбрать изображение"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"absolute inset-0 h-full w-full opacity-0 cursor-pointer",tabIndex:-1,"aria-label":"Выбрать изображение"})]}),x&&e.jsxs(c,{variant:"outline",className:"mt-1",onClick:()=>m(void 0),type:"button",children:[e.jsx(b,{size:14})," Удалить фото"]})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 -mx-4 mt-3 flex justify-end gap-2 border-t border-black/10 bg-white/90 px-4 py-3 backdrop-blur dark:border-white/10 dark:bg-neutral-900/90 rounded-b-2xl",children:[e.jsxs(c,{variant:"outline",onClick:n,type:"button",children:[e.jsx(b,{size:16})," Отмена"]}),e.jsxs(c,{type:"submit",children:[e.jsx(U,{size:16})," Сохранить"]})]})]})}function Q({open:s,initial:g,onClose:n,onSubmit:h}){return e.jsxs(O,{open:s,onClose:n,children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between gap-3 border-b border-black/10 bg-white/95 px-4 py-3 dark:border-white/10 dark:bg-neutral-900/95 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center gap-2 text-lg font-semibold",children:[e.jsx(X,{size:18})," ",g?"Редактировать событие":"Новое событие"]}),e.jsx(c,{variant:"ghost",onClick:n,children:e.jsx(b,{size:18})})]}),e.jsx("div",{className:"px-4",children:e.jsx($,{initial:g||void 0,onCancel:n,onSubmit:h})})]})}export{Q as default};
